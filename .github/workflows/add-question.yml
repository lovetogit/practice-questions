name: Add Question to HTML

on:
  repository_dispatch:
    types: [new-question]

jobs:
  update-file:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Add question to HTML
      run: |
        FILE="index.html"
        QUESTION="${{ github.event.client_payload.question }}"
        ANSWER="${{ github.event.client_payload.answer }}"
        BLOCK="<details><summary>${QUESTION}</summary><p>${ANSWER}</p></details>"

        # Append it to the end of file
        echo "$BLOCK" >> $FILE

    - name: Commit and push
      run: |
        git config user.name "github-actions[bot]"
        git config user.email "github-actions[bot]@users.noreply.github.com"
        git add index.html
        git commit -m "Add question: ${{ github.event.client_payload.question }}"
        git push

